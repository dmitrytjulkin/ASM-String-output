Turbo Assembler	 Version 4.1	    02/18/26 19:38:41	    Page 1
str-out.asm



      1	0000			     .model tiny
      2	0000			     .code
      3				     org 100h
      4
      5	      =B800		     VIDEOSEG		     equ 0b800h
      6	      =07CA		     CENTER_OF_FRAME	     equ 007CAh
      7	      =00A0		     PLACE_OF_UPPER_BORDER   equ 000A0h
      8	      =FF60		     PLACE_OF_LOWER_BORDER   equ 0FF60h
      9
     10	      =0082		     PLACE_OF_FIRST_CMD	     equ 00082h
     11	      =0085		     PLACE_OF_SECOND_CMD     equ 00085h
     12	      =0088		     PLACE_OF_INPUT	     equ 00088h
     13
     14	      =0007		     COUNT_TO_SKIP	     equ 7
     15
     16	      =0070		     TEXT_COLOR		     equ 070h
     17
     18	      =00CD		     HORIZONTAL_BORDER	     equ 0CDh
     19	      =00BA		     VERTICAL_BORDER	     equ 0BAh
     20	      =00C9		     TOP_LEFT_CORNER	     equ 0C9h
     21	      =00BB		     TOP_RIGHT_CORNER	     equ 0BBh
     22	      =00C8		     BOTTOM_LEFT_CORNER	     equ 0C8h
     23	      =00BC		     BOTTOM_RIGHT_CORNER     equ 0BCh
     24
     25	0100			     start:
     26	0100  B8 B800			     mov ax, VIDEOSEG
     27	0103  8E C0			     mov es, ax
     28
     29	0105  E8 0005			     call BuildFrame
     30
     31	0108  B8 4C00			     mov ax, 4c00h
     32	010B  CD 21			     int 21h
     33				     ;___________________________________________________________________________;
     34
     35
     36				     ;__BUILDFRAME__
     37				     ;Printing framed input string with	special	color
     38				     ;Entry: -
     39				     ;Exit: -
     40				     ;Destr: AX, BX, CX, DX, DI
     41				     ;___________________________________________________________________________;
     42	010D			     BuildFrame		     proc
     43	010D  B4 70			     mov ah, TEXT_COLOR			     ;init color of text
     44
     45	010F  E8 0065			     call BuildTopCorners
     46
     47	0112  BA 00A0			     mov dx, PLACE_OF_UPPER_BORDER
     48	0115  E8 000D			     call BuildHorizontalBorder
     49
     50	0118  E8 002B			     call PrintSentence
     51
     52				     ;	     call BuildVerticalBorder
     53
     54	011B  BA FF60			     mov dx, PLACE_OF_LOWER_BORDER
     55	011E  E8 0004			     call BuildHorizontalBorder
     56
     57	0121  E8 0077			     call BuildBottomCorners
Turbo Assembler	 Version 4.1	    02/18/26 19:38:41	    Page 2
str-out.asm



     58
     59	0124  C3			     ret
     60	0125				     endp
     61				     ;___________________________________________________________________________;
     62
     63
     64				     ;__BUILDHORIZONTALBORDER__
     65				     ;Printing the top and bottom horizontal borders
     66				     ;Entry: al	= color	of the text
     67				     ;Exit: -
     68				     ;Destr: BX, CX, DX, DI
     69				     ;___________________________________________________________________________;
     70	0125			     BuildHorizontalBorder   proc
     71	0125  E8 0097			     call FindInputStrlen
     72
     73	0128  8B D9			     mov bx, cx
     74	012A  E8 009C			     call RoundBxToEvenNum
     75	012D  81 EA 07CA		     sub dx, CENTER_OF_FRAME
     76	0131  03 DA			     add bx, dx			     ;choose if	it top border or bottom
     77	0133  F7 DB			     neg bx
     78	0135  8B FB			     mov di, bx			     ;di = place to print
     79
     80	0137  B0 CD			     mov al, HORIZONTAL_BORDER
     81
     82	0139  33 DB			     xor bx, bx
     83
     84	013B			     building_border:
     85	013B  D1 E3			     shl bx, 1
     86	013D  26: 89 01			     mov es:[di+bx], ax
     87	0140  D1 EB			     shr bx, 1
     88
     89	0142  43			     inc bx
     90
     91	0143  E2 F6			     loop building_border
     92
     93	0145  C3			     ret
     94	0146				     endp
     95				     ;___________________________________________________________________________;
     96
     97
     98				     ;__PRINTSENTENCE__
     99				     ;Printing the input string	and vertical borders on	each side.
    100				     ;Entry: al	= color	of text
    101				     ;Exit: -
    102				     ;Destr: BX, CX, DX, DI
    103				     ;___________________________________________________________________________;
    104	0146			     PrintSentence	     proc
    105	0146  E8 0076			     call FindInputStrlen
    106
    107	0149  8B D9			     mov bx, cx
    108	014B  E8 007B			     call RoundBxToEvenNum
    109	014E  81 EB 07CA		     sub bx, CENTER_OF_FRAME
    110	0152  F7 DB			     neg bx
    111	0154  8B FB			     mov di, bx
    112
    113	0156  B0 BA			     mov al, VERTICAL_BORDER
    114	0158  26: 89 45	FE		     mov es:[di-2], ax		     ;printing left border
Turbo Assembler	 Version 4.1	    02/18/26 19:38:41	    Page 3
str-out.asm



    115
    116	015C  A0 0088			     mov al, ds:[PLACE_OF_INPUT]     ;al = the 1st symbol of input
    117
    118	015F  33 DB			     xor bx, bx
    119
    120	0161			     building_sentence:
    121	0161  D1 E3			     shl bx, 1
    122	0163  26: 89 01			     mov es:[di+bx], ax
    123	0166  D1 EB			     shr bx, 1
    124
    125	0168  43			     inc bx
    126	0169  8A 87 0088		     mov al, ds:[PLACE_OF_INPUT+bx]
    127
    128	016D  E2 F2			     loop building_sentence
    129
    130	016F  D1 E3			     shl bx, 1
    131	0171  B0 BA			     mov al, VERTICAL_BORDER
    132	0173  26: 89 01			     mov es:[di+bx], ax		     ;printing right border
    133
    134	0176  C3			     ret
    135	0177				     endp
    136				     ;___________________________________________________________________________;
    137
    138
    139				     ;__BUILDTOPCORNERS__
    140				     ;Printing top right and left corners.
    141				     ;Entry: al	= color	of text
    142				     ;Exit: -
    143				     ;Destr: BX, CX, DI
    144				     ;___________________________________________________________________________;
    145	0177			     BuildTopCorners	     proc
    146	0177  E8 0045			     call FindInputStrlen
    147
    148	017A  8B D9			     mov bx, cx
    149	017C  E8 004A			     call RoundBxToEvenNum
    150	017F  BF 07CA			     mov di, CENTER_OF_FRAME
    151	0182  81 EF 00A0		     sub di, PLACE_OF_UPPER_BORDER   ;di = same	row as border, but in center
    152	0186  2B FB			     sub di, bx
    153
    154	0188  B0 C9			     mov al, TOP_LEFT_CORNER
    155	018A  83 EF 02			     sub di, 2			     ;di = the start of	top border
    156	018D  26: 89 05			     mov es:[di], ax
    157
    158	0190  D1 E1			     shl cx, 1
    159
    160	0192  B0 BB			     mov al, TOP_RIGHT_CORNER
    161	0194  03 F9			     add di, cx			     ;di = the end of top border
    162	0196  26: 89 45	02		     mov es:[di+2], ax
    163
    164	019A  C3			     ret
    165	019B				     endp
    166				     ;___________________________________________________________________________;
    167
    168
    169				     ;__BUILDBOTTOMCORNERS__
    170				     ;Printing bottom left and right corners of	frame.
    171				     ;Entry: AH	= color	of the text
Turbo Assembler	 Version 4.1	    02/18/26 19:38:41	    Page 4
str-out.asm



    172				     ;Exit: -
    173				     ;Destr: BX, CX, DI
    174				     ;___________________________________________________________________________;
    175	019B			     BuildBottomCorners	     proc
    176	019B  E8 0021			     call FindInputStrlen
    177
    178	019E  8B D9			     mov bx, cx
    179	01A0  E8 0026			     call RoundBxToEvenNum
    180	01A3  BF 07CA			     mov di, CENTER_OF_FRAME
    181	01A6  81 EF FF60		     sub di, PLACE_OF_LOWER_BORDER   ;di = same	row as border, but in center
    182	01AA  2B FB			     sub di, bx
    183
    184	01AC  B0 C8			     mov al, BOTTOM_LEFT_CORNER
    185	01AE  83 EF 02			     sub di, 2
    186	01B1  26: 89 05			     mov es:[di], ax		     ;printing bottom left corner
    187
    188	01B4  D1 E1			     shl cx, 1
    189
    190	01B6  B0 BC			     mov al, BOTTOM_RIGHT_CORNER
    191	01B8  03 F9			     add di, cx
    192	01BA  26: 89 45	02		     mov es:[di+2], ax		     ;printing bottom right corner
    193
    194	01BE  C3			     ret
    195	01BF				     endp
    196				     ;___________________________________________________________________________;
    197
    198
    199				     ;__SETCYCLECOUNTER__
    200				     ;Setting cx as counter of input symbols (the max value is 0EEh)
    201				     ;Entry: -
    202				     ;Exit: cx = count of input	symbols
    203				     ;Destr: -
    204				     ;___________________________________________________________________________;
    205	01BF			     FindInputStrlen proc
    206	01BF  8A 0E 0080		     mov cl, ds:[80h]
    207	01C3  B5 00			     mov ch, 00
    208
    209	01C5  83 E9 07			     sub cx, COUNT_TO_SKIP
    210
    211	01C8  C3			     ret
    212	01C9				     endp
    213				     ;__________________________________________________________________________;
    214
    215
    216				     ;__ROUNDBXTOEVENNUM__
    217				     ;Rounding value in	bx to the nearest and the lowest even number
    218				     ;Entry: BX	= value
    219				     ;Exit: BX = even value
    220				     ;Destr: -
    221				     ;__________________________________________________________________________;
    222	01C9			     RoundBxToEvenNum		     proc
    223	01C9  D1 EB			     shr bx, 1
    224	01CB  D1 E3			     shl bx, 1
    225
    226	01CD  C3			     ret
    227	01CE				     endp
    228				     ;__________________________________________________________________________;
Turbo Assembler	 Version 4.1	    02/18/26 19:38:41	    Page 5
str-out.asm



    229
    230				     end	     Start
Turbo Assembler	 Version 4.1	    02/18/26 19:38:41	    Page 6
Symbol Table




Symbol Name			  Type	 Value

??DATE				  Text	 "02/18/26"
??FILENAME			  Text	 "str-out "
??TIME				  Text	 "19:38:41"
??VERSION			  Number 040A
@32BIT				  Text	 0
@CODE				  Text	 DGROUP
@CODESIZE			  Text	 0
@CPU				  Text	 0101H
@CURSEG				  Text	 _TEXT
@DATA				  Text	 DGROUP
@DATASIZE			  Text	 0
@FILENAME			  Text	 STR-OUT
@INTERFACE			  Text	 000H
@MODEL				  Text	 1
@STACK				  Text	 DGROUP
@WORDSIZE			  Text	 2
BOTTOM_LEFT_CORNER		  Number 00C8
BOTTOM_RIGHT_CORNER		  Number 00BC
BUILDBOTTOMCORNERS		  Near	 DGROUP:019B
BUILDFRAME			  Near	 DGROUP:010D
BUILDHORIZONTALBORDER		  Near	 DGROUP:0125
BUILDING_BORDER			  Near	 DGROUP:013B
BUILDING_SENTENCE		  Near	 DGROUP:0161
BUILDTOPCORNERS			  Near	 DGROUP:0177
CENTER_OF_FRAME			  Number 07CA
COUNT_TO_SKIP			  Number 0007
FINDINPUTSTRLEN			  Near	 DGROUP:01BF
HORIZONTAL_BORDER		  Number 00CD
PLACE_OF_FIRST_CMD		  Number 0082
PLACE_OF_INPUT			  Number 0088
PLACE_OF_LOWER_BORDER		  Number FF60
PLACE_OF_SECOND_CMD		  Number 0085
PLACE_OF_UPPER_BORDER		  Number 00A0
PRINTSENTENCE			  Near	 DGROUP:0146
ROUNDBXTOEVENNUM		  Near	 DGROUP:01C9
START				  Near	 DGROUP:0100
TEXT_COLOR			  Number 0070
TOP_LEFT_CORNER			  Number 00C9
TOP_RIGHT_CORNER		  Number 00BB
VERTICAL_BORDER			  Number 00BA
VIDEOSEG			  Number B800

Groups & Segments		  Bit Size Align  Combine Class

DGROUP				  Group
  _DATA				  16  0000 Word	  Public  DATA
  _TEXT				  16  01CE Word	  Public  CODE
